"use strict";!function t(e,o,i){function n(a,s){if(!o[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var h=o[a]={exports:{}};e[a][0].call(h.exports,function(t){var o=e[a][1][t];return n(o?o:t)},h,h.exports,t,e,o,i)}return o[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(t,e,o){var i=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},n=SupEngine.THREE,r=function(t){function e(e,o,i){t.call(this,e,"GridHelper"),this.visible=!0,this.setup(o,i)}return i(e,t),e.prototype.setIsLayerActive=function(t){this.gridHelper.visible=t&&this.visible},e.prototype.setup=function(t,e){null!=this.gridHelper&&(this.actor.threeObject.remove(this.gridHelper),this.gridHelper.geometry.dispose(),this.gridHelper.material.dispose());var o=Math.ceil(t/e)*e;this.gridHelper=new n.GridHelper(o,o/e*2,new n.Color(1,1,1),new n.Color(1,1,1)),this.gridHelper.material.transparent=!0,this.gridHelper.material.opacity=.25,this.actor.threeObject.add(this.gridHelper),this.gridHelper.visible=this.visible,this.gridHelper.updateMatrixWorld(!1)},e.prototype.setVisible=function(t){this.gridHelper.visible=this.visible=t},e}(SupEngine.ActorComponent);Object.defineProperty(o,"__esModule",{value:!0}),o.default=r},{}],2:[function(t,e,o){var i=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},n=SupEngine.THREE,r=function(t){function e(e){t.call(this,e,"SelectionBox"),this.geometry=new n.Geometry;for(var o=0;o<24;o++)this.geometry.vertices.push(new n.Vector3(0,0,0));this.line=new n.LineSegments(this.geometry,new n.LineBasicMaterial({color:65535,opacity:1,depthTest:!1,depthWrite:!1,transparent:!0})),this.actor.threeObject.add(this.line),this.line.updateMatrixWorld(!1),this.line.visible=!1}return i(e,t),e.prototype.setIsLayerActive=function(t){this.line.visible=t&&null!=this.target},e.prototype.setTarget=function(t){this.target=t,this.line.visible=null!=this.target,null!=this.target&&(this.move(),this.resize())},e.prototype.move=function(){this.actor.threeObject.position.copy(this.target.getWorldPosition()),this.actor.threeObject.quaternion.copy(this.target.getWorldQuaternion()),this.actor.threeObject.updateMatrixWorld(!1)},e.prototype.resize=function(){var t=new n.Vector3,e=new n.Box3,o=(new n.Matrix4).compose(this.target.getWorldPosition(),this.target.getWorldQuaternion(),{x:1,y:1,z:1});o.getInverse(o),this.target.traverse(function(i){var r=i.geometry;if(null!=r)if(i.updateMatrixWorld(!1),r instanceof n.Geometry)for(var a=r.vertices,s=0,c=a.length;s<c;s++)t.copy(a[s]).applyMatrix4(i.matrixWorld).applyMatrix4(o),e.expandByPoint(t);else if(r instanceof n.BufferGeometry&&null!=r.attributes.position)for(var l=r.attributes.position.array,s=0,c=l.length;s<c;s+=3)t.set(l[s],l[s+1],l[s+2]),t.applyMatrix4(i.matrixWorld).applyMatrix4(o),e.expandByPoint(t)});var i=e.min,r=e.max;this.geometry.vertices[0].set(r.x,i.y,i.z),this.geometry.vertices[1].set(i.x,i.y,i.z),this.geometry.vertices[2].set(i.x,i.y,i.z),this.geometry.vertices[3].set(i.x,r.y,i.z),this.geometry.vertices[4].set(i.x,r.y,i.z),this.geometry.vertices[5].set(r.x,r.y,i.z),this.geometry.vertices[6].set(r.x,r.y,i.z),this.geometry.vertices[7].set(r.x,i.y,i.z),this.geometry.vertices[8].set(i.x,r.y,r.z),this.geometry.vertices[9].set(r.x,r.y,r.z),this.geometry.vertices[10].set(r.x,r.y,r.z),this.geometry.vertices[11].set(r.x,i.y,r.z),this.geometry.vertices[12].set(r.x,i.y,r.z),this.geometry.vertices[13].set(i.x,i.y,r.z),this.geometry.vertices[14].set(i.x,i.y,r.z),this.geometry.vertices[15].set(i.x,r.y,r.z),this.geometry.vertices[16].set(r.x,i.y,i.z),this.geometry.vertices[17].set(r.x,i.y,r.z),this.geometry.vertices[18].set(r.x,r.y,i.z),this.geometry.vertices[19].set(r.x,r.y,r.z),this.geometry.vertices[20].set(i.x,r.y,i.z),this.geometry.vertices[21].set(i.x,r.y,r.z),this.geometry.vertices[22].set(i.x,i.y,i.z),this.geometry.vertices[23].set(i.x,i.y,r.z),this.geometry.verticesNeedUpdate=!0},e.prototype._destroy=function(){this.actor.threeObject.remove(this.line),this.line.geometry.dispose(),this.line.material.dispose(),this.line=null,t.prototype._destroy.call(this)},e}(SupEngine.ActorComponent);Object.defineProperty(o,"__esModule",{value:!0}),o.default=r},{}],3:[function(t,e,o){!function(){var t=SupEngine.THREE,e=function(e){t.MeshBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.side=t.FrontSide,this.transparent=!0,this.setValues(e),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(t){t?(this.color.setRGB(1,1,0),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};e.prototype=Object.create(t.MeshBasicMaterial.prototype),e.prototype.constructor=e;var o=function(e){t.LineBasicMaterial.call(this),this.depthTest=!1,this.depthWrite=!1,this.transparent=!0,this.linewidth=1,this.setValues(e),this.oldColor=this.color.clone(),this.oldOpacity=this.opacity,this.highlight=function(t){t?(this.color.setRGB(1,1,0),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};o.prototype=Object.create(t.LineBasicMaterial.prototype),o.prototype.constructor=o;var i=new e({visible:!1,transparent:!1});t.TransformGizmo=function(){this.init=function(){t.Object3D.call(this),this.handles=new t.Object3D,this.pickers=new t.Object3D,this.planes=new t.Object3D,this.add(this.handles),this.add(this.pickers),this.add(this.planes);var e=new t.PlaneBufferGeometry(50,50,2,2),o=new t.MeshBasicMaterial({visible:!1,side:t.DoubleSide}),i={XY:new t.Mesh(e,o),YZ:new t.Mesh(e,o),XZ:new t.Mesh(e,o),XYZE:new t.Mesh(e,o)};this.activePlane=i.XYZE,i.YZ.rotation.set(0,Math.PI/2,0),i.XZ.rotation.set(-Math.PI/2,0,0);for(var n in i)i[n].name=n,this.planes.add(i[n]),this.planes[n]=i[n];var r=function(t,e){for(var o in t)for(n=t[o].length;n--;){var i=t[o][n][0],r=t[o][n][1],a=t[o][n][2];i.name=o,r&&i.position.set(r[0],r[1],r[2]),a&&i.rotation.set(a[0],a[1],a[2]),e.add(i)}};r(this.handleGizmos,this.handles),r(this.pickerGizmos,this.pickers),this.traverse(function(e){if(e instanceof t.Mesh){e.updateMatrix();var o=e.geometry.clone();o.applyMatrix(e.matrix),e.geometry=o,e.position.set(0,0,0),e.rotation.set(0,0,0),e.scale.set(1,1,1)}})},this.highlight=function(t){this.traverse(function(e){e.material&&e.material.highlight&&(e.name===t?e.material.highlight(!0):e.material.highlight(!1))})}},t.TransformGizmo.prototype=Object.create(t.Object3D.prototype),t.TransformGizmo.prototype.constructor=t.TransformGizmo,t.TransformGizmo.prototype.update=function(e,o){var i=new t.Vector3(0,0,0),n=new t.Vector3(0,1,0),r=new t.Matrix4;this.traverse(function(t){t.name.search("E")!==-1?t.quaternion.setFromRotationMatrix(r.lookAt(o,i,n)):t.name.search("X")===-1&&t.name.search("Y")===-1&&t.name.search("Z")===-1||t.quaternion.setFromEuler(e)})},t.TransformGizmoTranslate=function(){t.TransformGizmo.call(this);var n=new t.Geometry,r=new t.Mesh(new t.CylinderGeometry(0,.05,.2,12,1,!1));r.position.y=.5,r.updateMatrix(),n.merge(r.geometry,r.matrix);var a=new t.BufferGeometry;a.addAttribute("position",new t.Float32Attribute([0,0,0,1,0,0],3));var s=new t.BufferGeometry;s.addAttribute("position",new t.Float32Attribute([0,0,0,0,1,0],3));var c=new t.BufferGeometry;c.addAttribute("position",new t.Float32Attribute([0,0,0,0,0,1],3)),this.handleGizmos={X:[[new t.Mesh(n,new e({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new t.Line(a,new o({color:16711680}))]],Y:[[new t.Mesh(n,new e({color:65280})),[0,.5,0]],[new t.Line(s,new o({color:65280}))]],Z:[[new t.Mesh(n,new e({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new t.Line(c,new o({color:255}))]],XYZ:[[new t.Mesh(new t.OctahedronGeometry(.1,0),new e({color:16777215,opacity:.25})),[0,0,0],[0,0,0]]],XY:[[new t.Mesh(new t.PlaneBufferGeometry(.29,.29),new e({color:16776960,opacity:.25})),[.15,.15,0]]],YZ:[[new t.Mesh(new t.PlaneBufferGeometry(.29,.29),new e({color:65535,opacity:.25})),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new t.Mesh(new t.PlaneBufferGeometry(.29,.29),new e({color:16711935,opacity:.25})),[.15,0,.15],[-Math.PI/2,0,0]]]},this.pickerGizmos={X:[[new t.Mesh(new t.CylinderGeometry(.2,0,1,4,1,!1),i),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new t.Mesh(new t.CylinderGeometry(.2,0,1,4,1,!1),i),[0,.6,0]]],Z:[[new t.Mesh(new t.CylinderGeometry(.2,0,1,4,1,!1),i),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new t.Mesh(new t.OctahedronGeometry(.2,0),i)]],XY:[[new t.Mesh(new t.PlaneBufferGeometry(.4,.4),i),[.2,.2,0]]],YZ:[[new t.Mesh(new t.PlaneBufferGeometry(.4,.4),i),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new t.Mesh(new t.PlaneBufferGeometry(.4,.4),i),[.2,0,.2],[-Math.PI/2,0,0]]]},this.setActivePlane=function(e,o){var i=new t.Matrix4;o.applyMatrix4(i.getInverse(i.extractRotation(this.planes.XY.matrixWorld))),"X"===e&&(this.activePlane=this.planes.XY,Math.abs(o.y)>Math.abs(o.z)&&(this.activePlane=this.planes.XZ)),"Y"===e&&(this.activePlane=this.planes.XY,Math.abs(o.x)>Math.abs(o.z)&&(this.activePlane=this.planes.YZ)),"Z"===e&&(this.activePlane=this.planes.XZ,Math.abs(o.x)>Math.abs(o.y)&&(this.activePlane=this.planes.YZ)),"XYZ"===e&&(this.activePlane=this.planes.XYZE),"XY"===e&&(this.activePlane=this.planes.XY),"YZ"===e&&(this.activePlane=this.planes.YZ),"XZ"===e&&(this.activePlane=this.planes.XZ)},this.init()},t.TransformGizmoTranslate.prototype=Object.create(t.TransformGizmo.prototype),t.TransformGizmoTranslate.prototype.constructor=t.TransformGizmoTranslate,t.TransformGizmoRotate=function(){t.TransformGizmo.call(this);var e=function(e,o,i){var n=new t.BufferGeometry,r=[];i=i?i:1;for(var a=0;a<=64*i;++a)"x"===o&&r.push(0,Math.cos(a/32*Math.PI)*e,Math.sin(a/32*Math.PI)*e),"y"===o&&r.push(Math.cos(a/32*Math.PI)*e,0,Math.sin(a/32*Math.PI)*e),"z"===o&&r.push(Math.sin(a/32*Math.PI)*e,Math.cos(a/32*Math.PI)*e,0);return n.addAttribute("position",new t.Float32Attribute(r,3)),n};this.handleGizmos={X:[[new t.Line(new e(1,"x",.5),new o({color:16711680}))]],Y:[[new t.Line(new e(1,"y",.5),new o({color:65280}))]],Z:[[new t.Line(new e(1,"z",.5),new o({color:255}))]],E:[[new t.Line(new e(1.25,"z",1),new o({color:13421568}))]],XYZE:[[new t.Line(new e(1,"z",1),new o({color:7895160}))]]},this.pickerGizmos={X:[[new t.Mesh(new t.TorusGeometry(1,.12,4,12,Math.PI),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new t.Mesh(new t.TorusGeometry(1,.12,4,12,Math.PI),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new t.Mesh(new t.TorusGeometry(1,.12,4,12,Math.PI),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new t.Mesh(new t.TorusGeometry(1.25,.12,2,24),i)]],XYZE:[[new t.Mesh(new t.Geometry)]]},this.setActivePlane=function(t){"E"===t&&(this.activePlane=this.planes.XYZE),"X"===t&&(this.activePlane=this.planes.YZ),"Y"===t&&(this.activePlane=this.planes.XZ),"Z"===t&&(this.activePlane=this.planes.XY)},this.update=function(e,o){t.TransformGizmo.prototype.update.apply(this,arguments);var i=({handles:this.handles,pickers:this.pickers},new t.Matrix4),n=new t.Euler(0,0,1),r=new t.Quaternion,a=new t.Vector3(1,0,0),s=new t.Vector3(0,1,0),c=new t.Vector3(0,0,1),l=new t.Quaternion,h=new t.Quaternion,p=new t.Quaternion,u=o.clone();n.copy(this.planes.XY.rotation),r.setFromEuler(n),i.makeRotationFromQuaternion(r).getInverse(i),u.applyMatrix4(i),this.traverse(function(t){r.setFromEuler(n),"X"===t.name&&(l.setFromAxisAngle(a,Math.atan2(-u.y,u.z)),r.multiplyQuaternions(r,l),t.quaternion.copy(r)),"Y"===t.name&&(h.setFromAxisAngle(s,Math.atan2(u.x,u.z)),r.multiplyQuaternions(r,h),t.quaternion.copy(r)),"Z"===t.name&&(p.setFromAxisAngle(c,Math.atan2(u.y,u.x)),r.multiplyQuaternions(r,p),t.quaternion.copy(r))})},this.init()},t.TransformGizmoRotate.prototype=Object.create(t.TransformGizmo.prototype),t.TransformGizmoRotate.prototype.constructor=t.TransformGizmoRotate,t.TransformGizmoScale=function(){t.TransformGizmo.call(this);var n=new t.Geometry,r=new t.Mesh(new t.BoxGeometry(.125,.125,.125));r.position.y=.5,r.updateMatrix(),n.merge(r.geometry,r.matrix);var a=new t.BufferGeometry;a.addAttribute("position",new t.Float32Attribute([0,0,0,1,0,0],3));var s=new t.BufferGeometry;s.addAttribute("position",new t.Float32Attribute([0,0,0,0,1,0],3));var c=new t.BufferGeometry;c.addAttribute("position",new t.Float32Attribute([0,0,0,0,0,1],3)),this.handleGizmos={X:[[new t.Mesh(n,new e({color:16711680})),[.5,0,0],[0,0,-Math.PI/2]],[new t.Line(a,new o({color:16711680}))]],Y:[[new t.Mesh(n,new e({color:65280})),[0,.5,0]],[new t.Line(s,new o({color:65280}))]],Z:[[new t.Mesh(n,new e({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new t.Line(c,new o({color:255}))]],XYZ:[[new t.Mesh(new t.BoxGeometry(.125,.125,.125),new e({color:16777215,opacity:.25}))]]},this.pickerGizmos={X:[[new t.Mesh(new t.CylinderGeometry(.2,0,1,4,1,!1),i),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new t.Mesh(new t.CylinderGeometry(.2,0,1,4,1,!1),i),[0,.6,0]]],Z:[[new t.Mesh(new t.CylinderGeometry(.2,0,1,4,1,!1),i),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new t.Mesh(new t.BoxGeometry(.4,.4,.4),i)]]},this.setActivePlane=function(e,o){var i=new t.Matrix4;o.applyMatrix4(i.getInverse(i.extractRotation(this.planes.XY.matrixWorld))),"X"===e&&(this.activePlane=this.planes.XY,Math.abs(o.y)>Math.abs(o.z)&&(this.activePlane=this.planes.XZ)),"Y"===e&&(this.activePlane=this.planes.XY,Math.abs(o.x)>Math.abs(o.z)&&(this.activePlane=this.planes.YZ)),"Z"===e&&(this.activePlane=this.planes.XZ,Math.abs(o.x)>Math.abs(o.y)&&(this.activePlane=this.planes.YZ)),"XYZ"===e&&(this.activePlane=this.planes.XYZE)},this.init()},t.TransformGizmoScale.prototype=Object.create(t.TransformGizmo.prototype),t.TransformGizmoScale.prototype.constructor=t.TransformGizmoScale,t.TransformControls=function(e,o){function i(t){if(void 0!==c.object&&h!==!0&&(void 0===t.button||0===t.button)){var e=t.changedTouches?t.changedTouches[0]:t,o=s(e,p[l].pickers.children),i=null;o&&(i=o.object.name,t.preventDefault()),c.axis!==i&&(c.axis=i,c.update(),c.dispatchEvent(m))}}function n(t){if(void 0!==c.object&&h!==!0&&(void 0===t.button||0===t.button)){var e=t.changedTouches?t.changedTouches[0]:t;if(0===e.button||void 0===e.button){var o=s(e,p[l].pickers.children);if(o){t.preventDefault(),t.stopPropagation(),c.dispatchEvent(d),c.axis=o.object.name,c.update(),E.copy(_).sub(R).normalize(),p[l].setActivePlane(c.axis,E);var i=s(e,[p[l].activePlane]);i&&(L.copy(c.object.position),V.copy(c.object.scale),B.extractRotation(c.object.matrix),H.extractRotation(c.object.matrixWorld),C.extractRotation(c.object.parent.matrixWorld),W.setFromMatrixScale(P.getInverse(c.object.parent.matrixWorld)),M.copy(i.point))}}h=!0}}function r(t){if(void 0!==c.object&&null!==c.axis&&h!==!1&&(void 0===t.button||0===t.button)){var e=t.changedTouches?t.changedTouches[0]:t,o=s(e,[p[l].activePlane]);o!==!1&&(t.preventDefault(),t.stopPropagation(),w.copy(o.point),"translate"===l?(w.sub(M),w.multiply(W),"local"===c.space&&(w.applyMatrix4(P.getInverse(H)),c.axis.search("X")===-1&&(w.x=0),c.axis.search("Y")===-1&&(w.y=0),c.axis.search("Z")===-1&&(w.z=0),w.applyMatrix4(B),c.object.position.copy(L),c.object.position.add(w)),"world"!==c.space&&c.axis.search("XYZ")===-1||(c.axis.search("X")===-1&&(w.x=0),c.axis.search("Y")===-1&&(w.y=0),c.axis.search("Z")===-1&&(w.z=0),w.applyMatrix4(P.getInverse(C)),c.object.position.copy(L),c.object.position.add(w)),null!==c.translationSnap&&("local"===c.space&&c.object.position.applyMatrix4(P.getInverse(H)),c.axis.search("X")!==-1&&(c.object.position.x=Math.round(c.object.position.x/c.translationSnap)*c.translationSnap),c.axis.search("Y")!==-1&&(c.object.position.y=Math.round(c.object.position.y/c.translationSnap)*c.translationSnap),c.axis.search("Z")!==-1&&(c.object.position.z=Math.round(c.object.position.z/c.translationSnap)*c.translationSnap),"local"===c.space&&c.object.position.applyMatrix4(H))):"scale"===l?(w.sub(M),w.multiply(W),"local"===c.space&&("XYZ"===c.axis?(z=1+w.y/50,c.object.scale.x=V.x*z,c.object.scale.y=V.y*z,c.object.scale.z=V.z*z):(w.applyMatrix4(P.getInverse(H)),"X"===c.axis&&(c.object.scale.x=V.x*(1+w.x/50)),"Y"===c.axis&&(c.object.scale.y=V.y*(1+w.y/50)),"Z"===c.axis&&(c.object.scale.z=V.z*(1+w.z/50))))):"rotate"===l&&(w.sub(R),w.multiply(W),G.copy(M).sub(R),G.multiply(W),"E"===c.axis?(w.applyMatrix4(P.getInverse(j)),G.applyMatrix4(P.getInverse(j)),g.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x)),b.set(Math.atan2(G.z,G.y),Math.atan2(G.x,G.z),Math.atan2(G.y,G.x)),T.setFromRotationMatrix(P.getInverse(C)),F.setFromAxisAngle(E,g.z-b.z),Y.setFromRotationMatrix(H),T.multiplyQuaternions(T,F),T.multiplyQuaternions(T,Y),c.object.quaternion.copy(T)):"XYZE"===c.axis?(F.setFromEuler(w.clone().cross(G).normalize()),T.setFromRotationMatrix(P.getInverse(C)),Z.setFromAxisAngle(F,-w.clone().angleTo(G)),Y.setFromRotationMatrix(H),T.multiplyQuaternions(T,Z),T.multiplyQuaternions(T,Y),c.object.quaternion.copy(T)):"local"===c.space?(w.applyMatrix4(P.getInverse(H)),G.applyMatrix4(P.getInverse(H)),g.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x)),b.set(Math.atan2(G.z,G.y),Math.atan2(G.x,G.z),Math.atan2(G.y,G.x)),Y.setFromRotationMatrix(B),null!==c.rotationSnap?(Z.setFromAxisAngle(S,Math.round((g.x-b.x)/c.rotationSnap)*c.rotationSnap),O.setFromAxisAngle(A,Math.round((g.y-b.y)/c.rotationSnap)*c.rotationSnap),I.setFromAxisAngle(X,Math.round((g.z-b.z)/c.rotationSnap)*c.rotationSnap)):(Z.setFromAxisAngle(S,g.x-b.x),O.setFromAxisAngle(A,g.y-b.y),I.setFromAxisAngle(X,g.z-b.z)),"X"===c.axis&&Y.multiplyQuaternions(Y,Z),"Y"===c.axis&&Y.multiplyQuaternions(Y,O),"Z"===c.axis&&Y.multiplyQuaternions(Y,I),c.object.quaternion.copy(Y)):"world"===c.space&&(g.set(Math.atan2(w.z,w.y),Math.atan2(w.x,w.z),Math.atan2(w.y,w.x)),b.set(Math.atan2(G.z,G.y),Math.atan2(G.x,G.z),Math.atan2(G.y,G.x)),T.setFromRotationMatrix(P.getInverse(C)),null!==c.rotationSnap?(Z.setFromAxisAngle(S,Math.round((g.x-b.x)/c.rotationSnap)*c.rotationSnap),O.setFromAxisAngle(A,Math.round((g.y-b.y)/c.rotationSnap)*c.rotationSnap),I.setFromAxisAngle(X,Math.round((g.z-b.z)/c.rotationSnap)*c.rotationSnap)):(Z.setFromAxisAngle(S,g.x-b.x),O.setFromAxisAngle(A,g.y-b.y),I.setFromAxisAngle(X,g.z-b.z)),Y.setFromRotationMatrix(H),"X"===c.axis&&T.multiplyQuaternions(T,Z),"Y"===c.axis&&T.multiplyQuaternions(T,O),"Z"===c.axis&&T.multiplyQuaternions(T,I),T.multiplyQuaternions(T,Y),c.object.quaternion.copy(T))),c.update(),c.dispatchEvent(m),c.dispatchEvent(x))}}function a(t){void 0!==t.button&&0!==t.button||(h&&null!==c.axis&&(v.mode=l,c.dispatchEvent(v)),h=!1,i(t))}function s(t,i){var n=o.getBoundingClientRect(),r=(t.clientX-n.left)/n.width*2-1,a=-(t.clientY-n.top)/n.height*2+1;"perspective"===e.type?(f.ray.origin.setFromMatrixPosition(e.matrixWorld),f.ray.direction.set(r,a,.5).unproject(e).sub(f.ray.origin).normalize()):"orthographic"===e.type&&(f.ray.origin.set(r,a,-1).unproject(e),f.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld));var s=f.intersectObjects(i,!0);return!!s[0]&&s[0]}t.Object3D.call(this),o=void 0!==o?o:document,this.object=void 0,this.visible=!1,this.translationSnap=null,this.rotationSnap=null,this.space="world",this.size=1,this.axis=null;var c=this,l="translate",h=!1,p={translate:new t.TransformGizmoTranslate,rotate:new t.TransformGizmoRotate,scale:new t.TransformGizmoScale};for(var u in p){var y=p[u];y.visible=u===l,this.add(y)}var m={type:"change"},d={type:"mouseDown"},v={type:"mouseUp",mode:l},x={type:"objectChange"},f=new t.Raycaster,w=(new t.Vector2,new t.Vector3),M=new t.Vector3,g=new t.Vector3,b=new t.Vector3,z=1,j=new t.Matrix4,E=new t.Vector3,P=new t.Matrix4,G=new t.Vector3,T=new t.Quaternion,S=new t.Vector3(1,0,0),A=new t.Vector3(0,1,0),X=new t.Vector3(0,0,1),Y=new t.Quaternion,Z=new t.Quaternion,O=new t.Quaternion,I=new t.Quaternion,F=new t.Quaternion,L=new t.Vector3,V=new t.Vector3,B=new t.Matrix4,C=new t.Matrix4,W=new t.Vector3,R=new t.Vector3,Q=new t.Euler,H=new t.Matrix4,_=new t.Vector3,k=new t.Euler;o.addEventListener("mousedown",n,!1),o.addEventListener("touchstart",n,!1),o.addEventListener("mousemove",i,!1),o.addEventListener("touchmove",i,!1),o.addEventListener("mousemove",r,!1),o.addEventListener("touchmove",r,!1),o.addEventListener("mouseup",a,!1),o.addEventListener("mouseout",a,!1),o.addEventListener("touchend",a,!1),o.addEventListener("touchcancel",a,!1),o.addEventListener("touchleave",a,!1),this.dispose=function(){o.removeEventListener("mousedown",n),o.removeEventListener("touchstart",n),o.removeEventListener("mousemove",i),o.removeEventListener("touchmove",i),o.removeEventListener("mousemove",r),o.removeEventListener("touchmove",r),o.removeEventListener("mouseup",a),o.removeEventListener("mouseout",a),o.removeEventListener("touchend",a),o.removeEventListener("touchcancel",a),o.removeEventListener("touchleave",a)},this.attach=function(t){this.object=t,this.visible=!0,this.update()},this.detach=function(){this.object=void 0,this.visible=!1,this.axis=null},this.setMode=function(t){l=t?t:l,"scale"===l&&(c.space="local");for(var e in p)p[e].visible=e===l;this.update(),c.dispatchEvent(m)},this.setTranslationSnap=function(t){c.translationSnap=t},this.setRotationSnap=function(t){c.rotationSnap=t},this.setSize=function(t){c.size=t,this.update(),c.dispatchEvent(m)},this.setSpace=function(t){c.space=t,this.update(),c.dispatchEvent(m)},this.update=function(){void 0!==c.object&&(c.object.updateMatrixWorld(),R.setFromMatrixPosition(c.object.matrixWorld),Q.setFromRotationMatrix(P.extractRotation(c.object.matrixWorld)),e.updateMatrixWorld(),_.setFromMatrixPosition(e.matrixWorld),k.setFromRotationMatrix(P.extractRotation(e.matrixWorld)),z=R.distanceTo(_)/6*c.size,this.position.copy(R),this.scale.set(z,z,z),E.copy(_).sub(R).normalize(),"local"===c.space?p[l].update(Q,E):"world"===c.space&&p[l].update(new t.Euler,E),p[l].highlight(c.axis))}},t.TransformControls.prototype=Object.create(t.Object3D.prototype),t.TransformControls.prototype.constructor=t.TransformControls}()},{}],4:[function(t,e,o){var i=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},n=SupEngine.THREE;t("./TransformControls");var r=function(t){function e(e,o){t.call(this,e,"TransformHandle"),this.mode="translate",this.space="world",this.controlVisible=!1,this.control=new n.TransformControls(o,e.gameInstance.threeRenderer.domElement),this.actor.gameInstance.threeScene.add(this.control)}return i(e,t),e.prototype.setIsLayerActive=function(t){this.control.visible=t&&this.controlVisible},e.prototype.update=function(){this.control.update(),this.control.updateMatrixWorld(!0)},e.prototype.setMode=function(t){this.mode=t,null!=this.target&&(this.control.setMode(t),this.control.setSpace("scale"===this.mode?"local":this.space))},e.prototype.setSpace=function(t){this.space=t,null!=this.target&&"scale"!==this.mode&&this.control.setSpace(t)},e.prototype.setTarget=function(t){this.target=t,null!=this.target?(this.controlVisible=!0,this.control.attach(this.actor.threeObject),this.control.setSpace("scale"===this.mode?"local":this.space),this.control.setMode(this.mode),this.move()):(this.controlVisible=!1,this.control.detach())},e.prototype.move=function(){this.actor.threeObject.position.copy(this.target.getWorldPosition()),this.actor.threeObject.quaternion.copy(this.target.getWorldQuaternion()),this.actor.threeObject.scale.copy(this.target.scale),this.actor.threeObject.updateMatrixWorld(!1),this.control.update(),this.control.updateMatrixWorld(!0)},e.prototype._destroy=function(){this.controlVisible=!1,this.control.detach(),this.actor.gameInstance.threeScene.remove(this.control),t.prototype._destroy.call(this)},e}(SupEngine.ActorComponent);Object.defineProperty(o,"__esModule",{value:!0}),o.default=r},{"./TransformControls":3}],5:[function(t,e,o){var i=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},n=SupEngine.THREE,r=function(t){function e(e){t.call(this,e,"TransformMarker"),this.visible=!0;var o=new n.Geometry;o.vertices.push(new n.Vector3(-.25,0,0),new n.Vector3(.25,0,0),new n.Vector3(0,-.25,0),new n.Vector3(0,.25,0),new n.Vector3(0,0,-.25),new n.Vector3(0,0,.25)),this.line=new n.LineSegments(o,new n.LineBasicMaterial({color:16777215,opacity:.25,transparent:!0})),this.actor.threeObject.add(this.line),this.line.updateMatrixWorld(!1)}return i(e,t),e.prototype.setIsLayerActive=function(t){this.line.visible=t&&this.visible},e.prototype.move=function(t){this.visible=this.line.visible=!0,this.actor.threeObject.position.copy(t.getWorldPosition()),this.actor.threeObject.quaternion.copy(t.getWorldQuaternion()),this.actor.threeObject.updateMatrixWorld(!1)},e.prototype.hide=function(){this.visible=this.line.visible=!1},e.prototype._destroy=function(){this.actor.threeObject.remove(this.line),this.line.geometry.dispose(),this.line.material.dispose(),this.line=null,t.prototype._destroy.call(this)},e}(SupEngine.ActorComponent);Object.defineProperty(o,"__esModule",{value:!0}),o.default=r},{}],6:[function(t,e,o){var i=t("./SelectionBox"),n=t("./TransformHandle"),r=t("./TransformMarker"),a=t("./GridHelper");SupEngine.registerEditorComponentClass("SelectionBox",i.default),SupEngine.registerEditorComponentClass("TransformHandle",n.default),SupEngine.registerEditorComponentClass("TransformMarker",r.default),SupEngine.registerEditorComponentClass("GridHelper",a.default)},{"./GridHelper":1,"./SelectionBox":2,"./TransformHandle":4,"./TransformMarker":5}]},{},[6]);