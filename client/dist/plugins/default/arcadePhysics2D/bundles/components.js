"use strict";!function t(e,i,o){function s(r,h){if(!i[r]){if(!e[r]){var c="function"==typeof require&&require;if(!h&&c)return c(r,!0);if(n)return n(r,!0);var a=new Error("Cannot find module '"+r+"'");throw a.code="MODULE_NOT_FOUND",a}var l=i[r]={exports:{}};e[r][0].call(l.exports,function(t){var i=e[r][1][t];return s(i?i:t)},l,l.exports,t,e,i,o)}return i[r].exports}for(var n="function"==typeof require&&require,r=0;r<o.length;r++)s(o[r]);return s}({1:[function(t,e,i){var o=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=SupEngine.THREE,n=new s.Vector3,r=function(t){function e(e,i){t.call(this,e,"ArcadeBody2D"),this.enabled=!0,this.movable=!1,this.width=1,this.height=1,this.offsetX=0,this.offsetY=0,this.bounceX=0,this.bounceY=0,this.layersIndex=[],this.customGravity={x:null,y:null},this.touches={top:!1,bottom:!1,right:!1,left:!1},SupEngine.ArcadePhysics2D.allBodies.push(this)}return o(e,t),e.prototype.setIsLayerActive=function(t){},e.prototype.setupBox=function(t){this.type="box",this.movable=t.movable,this.width=t.width,this.height=t.height,null!=t.offset&&(this.offsetX=t.offset.x,this.offsetY=t.offset.y),null!=t.bounce&&(this.bounceX=t.bounce.x,this.bounceY=t.bounce.y),this.actorPosition=this.actor.getGlobalPosition(new s.Vector3),this.position=this.actorPosition.clone(),this.position.x+=this.offsetX,this.position.y+=this.offsetY,this.previousPosition=this.position.clone(),this.velocity=new s.Vector3(0,0,0),this.velocityMin=new s.Vector3(-(1/0),-(1/0),-(1/0)),this.velocityMax=new s.Vector3(1/0,1/0,1/0),this.velocityMultiplier=new s.Vector3(1,1,1)},e.prototype.setupTileMap=function(t){if(this.type="tileMap",this.tileMapAsset=t.tileMapAsset,this.tileSetAsset=t.tileSetAsset,this.mapToSceneFactor={x:this.tileSetAsset.__inner.data.grid.width/this.tileMapAsset.__inner.data.pixelsPerUnit,y:this.tileSetAsset.__inner.data.grid.height/this.tileMapAsset.__inner.data.pixelsPerUnit},this.tileSetPropertyName=t.tileSetPropertyName,null!=t.layersIndex)for(var e=t.layersIndex.split(","),i=0,o=e;i<o.length;i++){var n=o[i];this.layersIndex.push(parseInt(n.trim(),10))}else for(var r=0;r<this.tileMapAsset.__inner.data.layers.length;r++)this.layersIndex.push(r);this.position=this.actor.getGlobalPosition(new s.Vector3)},e.prototype.earlyUpdate=function(){"tileMap"!==this.type&&(this.previousPosition.copy(this.position),this.movable&&this.enabled&&(this.velocity.x+=null!=this.customGravity.x?this.customGravity.x:SupEngine.ArcadePhysics2D.gravity.x,this.velocity.x*=this.velocityMultiplier.x,this.velocity.x=Math.min(Math.max(this.velocity.x,this.velocityMin.x),this.velocityMax.x),this.velocity.y+=null!=this.customGravity.y?this.customGravity.y:SupEngine.ArcadePhysics2D.gravity.y,this.velocity.y*=this.velocityMultiplier.y,this.velocity.y=Math.min(Math.max(this.velocity.y,this.velocityMin.y),this.velocityMax.y),this.position.add(this.velocity),this.refreshActorPosition()))},e.prototype.warpPosition=function(t,e){this.position.x=t+this.offsetX,this.position.y=e+this.offsetY,this.refreshActorPosition()},e.prototype.refreshActorPosition=function(){this.actor.getGlobalPosition(this.actorPosition),this.actorPosition.x=this.position.x-this.offsetX,this.actorPosition.y=this.position.y-this.offsetY,this.actor.setGlobalPosition(n.copy(this.actorPosition))},e.prototype._destroy=function(){SupEngine.ArcadePhysics2D.allBodies.splice(SupEngine.ArcadePhysics2D.allBodies.indexOf(this),1),t.prototype._destroy.call(this)},e.prototype.right=function(){return this.position.x+this.width/2},e.prototype.left=function(){return this.position.x-this.width/2},e.prototype.top=function(){return this.position.y+this.height/2},e.prototype.bottom=function(){return this.position.y-this.height/2},e.prototype.deltaX=function(){return this.position.x-this.previousPosition.x},e.prototype.deltaY=function(){return this.position.y-this.previousPosition.y},e}(SupEngine.ActorComponent);Object.defineProperty(i,"__esModule",{value:!0}),i.default=r},{}],2:[function(t,e,i){var o=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},s=t("./ArcadeBody2DUpdater"),n=SupEngine.THREE,r=new n.Vector3,h=function(t){function e(e){t.call(this,e,"ArcadeBody2DMarker"),this.offset=new n.Vector3(0,0,0),this.markerActor=new SupEngine.Actor(this.actor.gameInstance,"Marker",null,{layer:-1})}return o(e,t),e.prototype.setIsLayerActive=function(t){null!=this.line&&(this.line.visible=t)},e.prototype.update=function(){t.prototype.update.call(this),this.markerActor.setGlobalPosition(this.actor.getGlobalPosition(r))},e.prototype.setBox=function(t,e){null!=this.line&&this._clearRenderer();var i=new n.Geometry;i.vertices.push(new n.Vector3(-t/2,-e/2,.01),new n.Vector3(t/2,-e/2,.01),new n.Vector3(t/2,e/2,.01),new n.Vector3(-t/2,e/2,.01),new n.Vector3(-t/2,-e/2,.01));var o=new n.LineBasicMaterial({color:16013796});this.line=new n.Line(i,o),this.markerActor.threeObject.add(this.line),this.setOffset()},e.prototype.setOffset=function(t,e){null!=t&&null!=e&&this.offset.set(t,e,0),this.line.position.set(this.offset.x,this.offset.y,0),this.line.updateMatrixWorld(!1)},e.prototype.setTileMap=function(){null!=this.line&&this._clearRenderer()},e.prototype._clearRenderer=function(){this.markerActor.threeObject.remove(this.line),this.line.geometry.dispose(),this.line.material.dispose(),this.line=null},e.prototype._destroy=function(){null!=this.line&&this._clearRenderer(),this.actor.gameInstance.destroyActor(this.markerActor),this.markerActor=null,t.prototype._destroy.call(this)},e.Updater=s.default,e}(SupEngine.ActorComponent);Object.defineProperty(i,"__esModule",{value:!0}),i.default=h},{"./ArcadeBody2DUpdater":3}],3:[function(t,e,i){var o=function(){function t(t,e,i){this.projectClient=t,this.bodyRenderer=e,this.config=i,this.setType()}return t.prototype.destroy=function(){},t.prototype.config_setProperty=function(t,e){"width"!==t&&"height"!==t||this.bodyRenderer.setBox(this.config.width,this.config.height),"offset.x"!==t&&"offset.y"!==t||this.bodyRenderer.setOffset(this.config.offset.x,this.config.offset.y),"type"===t&&this.setType()},t.prototype.setType=function(){"box"===this.config.type?(this.bodyRenderer.setBox(this.config.width,this.config.height),this.bodyRenderer.setOffset(this.config.offset.x,this.config.offset.y)):this.bodyRenderer.setTileMap()},t}();Object.defineProperty(i,"__esModule",{value:!0}),i.default=o},{}],4:[function(t,e,i){var o,s=1e-4,n=SupEngine.THREE,r=t("./ArcadeBody2D"),h=t("./ArcadeBody2DMarker");!function(t){function e(t,e){return"tileMap"===e.type?o(t,e,{moveBody:!1}):!(t.right()<e.left())&&(!(t.left()>e.right())&&(!(t.bottom()>e.top())&&!(t.top()<e.bottom())))}function i(t,e){var i=t.position.x-e.position.x;i>=0?i-=(t.width+e.width)/2:i+=(t.width+e.width)/2;var o=t.position.y-e.position.y;o>=0?o-=(t.height+e.height)/2:o+=(t.height+e.height)/2,Math.abs(o)<=Math.abs(i)?(t.deltaY()/o>0&&(t.velocity.y=-t.velocity.y*t.bounceY,t.position.y-=o),t.position.y>e.position.y?t.touches.bottom=!0:t.touches.top=!0):(t.deltaX()/i>0&&(t.velocity.x=-t.velocity.x*t.bounceX,t.position.x-=i),t.position.x>e.position.x?t.touches.left=!0:t.touches.right=!0)}function o(t,e,i){function o(){for(var o=t.deltaX()<0?Math.floor((t.position.x-e.position.x-t.width/2)/e.mapToSceneFactor.x):Math.floor((t.position.x-e.position.x+t.width/2-s)/e.mapToSceneFactor.x),n=t.position.y-e.position.y-t.height/2+s,r=t.height-3*s,h=Math.ceil(r/e.mapToSceneFactor.y),c=0;c<=h;c++)for(var a=0,l=e.layersIndex;a<l.length;a++){var p=l[a],y=e.tileMapAsset.getTileAt(p,o,Math.floor((n+c*r/h)/e.mapToSceneFactor.y)),u=!1;if(null!=e.tileSetPropertyName?u=null!=e.tileSetAsset.getTileProperties(y)[e.tileSetPropertyName]:y!==-1&&(u=!0),u)return t.velocity.x=-t.velocity.x*t.bounceX,t.deltaX()<0?(i.moveBody&&(t.position.x=(o+1)*e.mapToSceneFactor.x+e.position.x+t.width/2),t.touches.left=!0):(i.moveBody&&(t.position.x=o*e.mapToSceneFactor.x+e.position.x-t.width/2),t.touches.right=!0),!0}return!1}function n(){for(var o=t.position.x-e.position.x-t.width/2+s,n=t.deltaY()<0?Math.floor((t.position.y-e.position.y-t.height/2)/e.mapToSceneFactor.y):Math.floor((t.position.y-e.position.y+t.height/2-s)/e.mapToSceneFactor.y),r=t.width-3*s,h=Math.ceil(r/e.mapToSceneFactor.x),c=0;c<=h;c++)for(var a=0,l=e.layersIndex;a<l.length;a++){var p=l[a],y=e.tileMapAsset.getTileAt(p,Math.floor((o+c*r/h)/e.mapToSceneFactor.x),n),u=!1;if(null!=e.tileSetPropertyName?u=null!=e.tileSetAsset.getTileProperties(y)[e.tileSetPropertyName]:y!==-1&&(u=!0),u)return t.velocity.y=-t.velocity.y*t.bounceY,t.deltaY()<0?(i.moveBody&&(t.position.y=(n+1)*e.mapToSceneFactor.y+e.position.y+t.height/2),t.touches.bottom=!0):(i.moveBody&&(t.position.y=n*e.mapToSceneFactor.y+e.position.y-t.height/2),t.touches.top=!0),!0}return!1}var r=t.position.x;t.position.x=t.previousPosition.x;var h=!1;return n()&&(h=!0),t.position.x=r,o()&&(h=!0),h}function r(t,s){if("tileMap"===t.type||!t.movable)throw new Error("The first body must be a movable box in ArcadePhysics2D.collides");if(t.touches.top=!1,t.touches.bottom=!1,t.touches.right=!1,t.touches.left=!1,!t.enabled)return!1;for(var n=!1,r=0,h=s;r<h.length;r++){var c=h[r];c!==t&&c.enabled&&("box"===c.type?e(t,c)&&(n=!0,i(t,c)):"tileMap"===c.type&&o(t,c,{moveBody:!0})&&(n=!0))}return n&&t.refreshActorPosition(),n}t.allBodies=[],t.gravity=new n.Vector3(0,0,0),t.intersects=e,t.collides=r}(o||(o={})),SupEngine.ArcadePhysics2D=o,SupEngine.registerEarlyUpdateFunction("ArcadePhysics2D",function(){for(var t=0,e=o.allBodies;t<e.length;t++){var i=e[t];i.earlyUpdate()}}),SupEngine.registerComponentClass("ArcadeBody2D",r.default),SupEngine.registerEditorComponentClass("ArcadeBody2DMarker",h.default)},{"./ArcadeBody2D":1,"./ArcadeBody2DMarker":2}]},{},[4]);