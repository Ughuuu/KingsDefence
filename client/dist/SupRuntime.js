"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};!function(n){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.SupRuntime=n()}}(function(){var n;return function n(t,e,r){function o(u,c){if(!e[u]){if(!t[u]){var a="function"==typeof require&&require;if(!c&&a)return a(u,!0);if(i)return i(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var s=e[u]={exports:{}};t[u][0].call(s.exports,function(n){var e=t[u][1][n];return o(e?e:n)},s,s.exports,n,t,e,r)}return e[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(n,t,e){function r(n,t,e){var r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType=t,r.onload=function(n){return 200!==r.status&&0!==r.status?void e(new Error("HTTP "+r.status+": "+r.statusText)):void e(null,r.response)},r.onerror=function(n){console.log(n),e(new Error("Network error: "+n.target.status))},r.send()}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},{}],2:[function(t,e,r){(function(t,r){!function(){function o(){}function i(n){return n}function u(n){return!!n}function c(n){return!n}function a(n){return function(){if(null===n)throw new Error("Callback was already called.");n.apply(this,arguments),n=null}}function l(n){return function(){null!==n&&(n.apply(this,arguments),n=null)}}function s(n){return M(n)||"number"==typeof n.length&&n.length>=0&&n.length%1===0}function f(n,t){for(var e=-1,r=n.length;++e<r;)t(n[e],e,n)}function p(n,t){for(var e=-1,r=n.length,o=Array(r);++e<r;)o[e]=t(n[e],e,n);return o}function d(n){return p(Array(n),function(n,t){return t})}function h(n,t,e){return f(n,function(n,r,o){e=t(e,n,r,o)}),e}function y(n,t){f(N(n),function(e){t(n[e],e)})}function m(n,t){for(var e=0;e<n.length;e++)if(n[e]===t)return e;return-1}function v(n){var t,e,r=-1;return s(n)?(t=n.length,function(){return r++,r<t?r:null}):(e=N(n),t=e.length,function(){return r++,r<t?e[r]:null})}function g(n,t){return t=null==t?n.length-1:+t,function(){for(var e=Math.max(arguments.length-t,0),r=Array(e),o=0;o<e;o++)r[o]=arguments[o+t];switch(t){case 0:return n.call(this,r);case 1:return n.call(this,arguments[0],r)}}}function w(n){return function(t,e,r){return n(t,r)}}function b(n){return function(t,e,r){r=l(r||o),t=t||[];var i=v(t);if(n<=0)return r(null);var u=!1,c=0,s=!1;!function o(){if(u&&c<=0)return r(null);for(;c<n&&!s;){var l=i();if(null===l)return u=!0,void(c<=0&&r(null));c+=1,e(t[l],l,a(function(n){c-=1,n?(r(n),s=!0):o()}))}}()}}function S(n){return function(t,e,r){return n(U.eachOf,t,e,r)}}function k(n){return function(t,e,r,o){return n(b(e),t,r,o)}}function T(n){return function(t,e,r){return n(U.eachOfSeries,t,e,r)}}function O(n,t,e,r){r=l(r||o),t=t||[];var i=s(t)?[]:{};n(t,function(n,t,r){e(n,function(n,e){i[t]=e,r(n)})},function(n){r(n,i)})}function E(n,t,e,r){var o=[];n(t,function(n,t,r){e(n,function(e){e&&o.push({index:t,value:n}),r()})},function(){r(p(o.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})}function L(n,t,e,r){E(n,t,function(n,t){e(n,function(n){t(!n)})},r)}function A(n,t,e){return function(r,o,i,u){function c(){u&&u(e(!1,void 0))}function a(n,r,o){return u?void i(n,function(r){u&&t(r)&&(u(e(!0,n)),u=i=!1),o()}):o()}arguments.length>3?n(r,o,a,c):(u=i,i=o,n(r,a,c))}}function j(n,t){return t}function I(n,t,e){e=e||o;var r=s(t)?[]:{};n(t,function(n,t,e){n(g(function(n,o){o.length<=1&&(o=o[0]),r[t]=o,e(n)}))},function(n){e(n,r)})}function x(n,t,e,r){var o=[];n(t,function(n,t,r){e(n,function(n,t){o=o.concat(t||[]),r(n)})},function(n){r(n,o)})}function _(n,t,e){function r(n,t,e,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");return n.started=!0,M(t)||(t=[t]),0===t.length&&n.idle()?U.setImmediate(function(){n.drain()}):(f(t,function(t){var i={data:t,callback:r||o};e?n.tasks.unshift(i):n.tasks.push(i),n.tasks.length===n.concurrency&&n.saturated()}),void U.setImmediate(n.process))}function i(n,t){return function(){u-=1;var e=!1,r=arguments;f(t,function(n){f(c,function(t,r){t!==n||e||(c.splice(r,1),e=!0)}),n.callback.apply(n,r)}),n.tasks.length+u===0&&n.drain(),n.process()}}if(null==t)t=1;else if(0===t)throw new Error("Concurrency must not be zero");var u=0,c=[],l={tasks:[],concurrency:t,payload:e,saturated:o,empty:o,drain:o,started:!1,paused:!1,push:function(n,t){r(l,n,!1,t)},kill:function(){l.drain=o,l.tasks=[]},unshift:function(n,t){r(l,n,!0,t)},process:function(){for(;!l.paused&&u<l.concurrency&&l.tasks.length;){var t=l.payload?l.tasks.splice(0,l.payload):l.tasks.splice(0,l.tasks.length),e=p(t,function(n){return n.data});0===l.tasks.length&&l.empty(),u+=1,c.push(t[0]);var r=a(i(l,t));n(e,r)}},length:function(){return l.tasks.length},running:function(){return u},workersList:function(){return c},idle:function(){return l.tasks.length+u===0},pause:function(){l.paused=!0},resume:function(){if(l.paused!==!1){l.paused=!1;for(var n=Math.min(l.concurrency,l.tasks.length),t=1;t<=n;t++)U.setImmediate(l.process)}}};return l}function P(n){return g(function(t,e){t.apply(null,e.concat([g(function(t,e){"object"===("undefined"==typeof console?"undefined":_typeof(console))&&(t?console.error&&console.error(t):console[n]&&f(e,function(t){console[n](t)}))})]))})}function C(n){return function(t,e,r){n(d(t),e,r)}}function R(n){return g(function(t,e){var r=g(function(e){var r=this,o=e.pop();return n(t,function(n,t,o){n.apply(r,e.concat([o]))},o)});return e.length?r.apply(this,e):r})}function q(n){return g(function(t){var e=t.pop();t.push(function(){var n=arguments;r?U.setImmediate(function(){e.apply(null,n)}):e.apply(null,n)});var r=!0;n.apply(this,t),r=!1})}var B,U={},F="object"===("undefined"==typeof self?"undefined":_typeof(self))&&self.self===self&&self||"object"===("undefined"==typeof r?"undefined":_typeof(r))&&r.global===r&&r||this;null!=F&&(B=F.async),U.noConflict=function(){return F.async=B,U};var D=Object.prototype.toString,M=Array.isArray||function(n){return"[object Array]"===D.call(n)},z=function(n){var t="undefined"==typeof n?"undefined":_typeof(n);return"function"===t||"object"===t&&!!n},N=Object.keys||function(n){var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t},W="function"==typeof setImmediate&&setImmediate,H=W?function(n){W(n)}:function(n){setTimeout(n,0)};"object"===("undefined"==typeof t?"undefined":_typeof(t))&&"function"==typeof t.nextTick?U.nextTick=t.nextTick:U.nextTick=H,U.setImmediate=W?H:U.nextTick,U.forEach=U.each=function(n,t,e){return U.eachOf(n,w(t),e)},U.forEachSeries=U.eachSeries=function(n,t,e){return U.eachOfSeries(n,w(t),e)},U.forEachLimit=U.eachLimit=function(n,t,e,r){return b(t)(n,w(e),r)},U.forEachOf=U.eachOf=function(n,t,e){function r(n){c--,n?e(n):null===i&&c<=0&&e(null)}e=l(e||o),n=n||[];for(var i,u=v(n),c=0;null!=(i=u());)c+=1,t(n[i],i,a(r));0===c&&e(null)},U.forEachOfSeries=U.eachOfSeries=function(n,t,e){function r(){var o=!0;return null===u?e(null):(t(n[u],u,a(function(n){if(n)e(n);else{if(u=i(),null===u)return e(null);o?U.setImmediate(r):r()}})),void(o=!1))}e=l(e||o),n=n||[];var i=v(n),u=i();r()},U.forEachOfLimit=U.eachOfLimit=function(n,t,e,r){b(t)(n,e,r)},U.map=S(O),U.mapSeries=T(O),U.mapLimit=k(O),U.inject=U.foldl=U.reduce=function(n,t,e,r){U.eachOfSeries(n,function(n,r,o){e(t,n,function(n,e){t=e,o(n)})},function(n){r(n,t)})},U.foldr=U.reduceRight=function(n,t,e,r){var o=p(n,i).reverse();U.reduce(o,t,e,r)},U.transform=function(n,t,e,r){3===arguments.length&&(r=e,e=t,t=M(n)?[]:{}),U.eachOf(n,function(n,r,o){e(t,n,r,o)},function(n){r(n,t)})},U.select=U.filter=S(E),U.selectLimit=U.filterLimit=k(E),U.selectSeries=U.filterSeries=T(E),U.reject=S(L),U.rejectLimit=k(L),U.rejectSeries=T(L),U.any=U.some=A(U.eachOf,u,i),U.someLimit=A(U.eachOfLimit,u,i),U.all=U.every=A(U.eachOf,c,c),U.everyLimit=A(U.eachOfLimit,c,c),U.detect=A(U.eachOf,i,j),U.detectSeries=A(U.eachOfSeries,i,j),U.detectLimit=A(U.eachOfLimit,i,j),U.sortBy=function(n,t,e){function r(n,t){var e=n.criteria,r=t.criteria;return e<r?-1:e>r?1:0}U.map(n,function(n,e){t(n,function(t,r){t?e(t):e(null,{value:n,criteria:r})})},function(n,t){return n?e(n):void e(null,p(t.sort(r),function(n){return n.value}))})},U.auto=function(n,t,e){function r(n){v.unshift(n)}function i(n){var t=m(v,n);t>=0&&v.splice(t,1)}function u(){a--,f(v.slice(0),function(n){n()})}"function"==typeof arguments[1]&&(e=t,t=null),e=l(e||o);var c=N(n),a=c.length;if(!a)return e(null);t||(t=a);var s={},p=0,d=!1,v=[];r(function(){a||e(null,s)}),f(c,function(o){function c(){return p<t&&h(w,function(n,t){return n&&s.hasOwnProperty(t)},!0)&&!s.hasOwnProperty(o)}function a(){c()&&(p++,i(a),f[f.length-1](v,s))}if(!d){for(var l,f=M(n[o])?n[o]:[n[o]],v=g(function(n,t){if(p--,t.length<=1&&(t=t[0]),n){var r={};y(s,function(n,t){r[t]=n}),r[o]=t,d=!0,e(n,r)}else s[o]=t,U.setImmediate(u)}),w=f.slice(0,f.length-1),b=w.length;b--;){if(!(l=n[w[b]]))throw new Error("Has nonexistent dependency in "+w.join(", "));if(M(l)&&m(l,o)>=0)throw new Error("Has cyclic dependencies")}c()?(p++,f[f.length-1](v,s)):r(a)}})},U.retry=function(n,t,e){function r(n,t){if("number"==typeof t)n.times=parseInt(t,10)||i;else{if("object"!==("undefined"==typeof t?"undefined":_typeof(t)))throw new Error("Unsupported argument type for 'times': "+("undefined"==typeof t?"undefined":_typeof(t)));n.times=parseInt(t.times,10)||i,n.interval=parseInt(t.interval,10)||u}}function o(n,t){function e(n,e){return function(r){n(function(n,t){r(!n||e,{err:n,result:t})},t)}}function r(n){return function(t){setTimeout(function(){t(null)},n)}}for(;a.times;){var o=!(a.times-=1);c.push(e(a.task,o)),!o&&a.interval>0&&c.push(r(a.interval))}U.series(c,function(t,e){e=e[e.length-1],(n||a.callback)(e.err,e.result)})}var i=5,u=0,c=[],a={times:i,interval:u},l=arguments.length;if(l<1||l>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return l<=2&&"function"==typeof n&&(e=t,t=n),"function"!=typeof n&&r(a,n),a.callback=e,a.task=t,a.callback?o():o},U.waterfall=function(n,t){function e(n){return g(function(r,o){if(r)t.apply(null,[r].concat(o));else{var i=n.next();i?o.push(e(i)):o.push(t),q(n).apply(null,o)}})}if(t=l(t||o),!M(n)){var r=new Error("First argument to waterfall must be an array of functions");return t(r)}return n.length?void e(U.iterator(n))():t()},U.parallel=function(n,t){I(U.eachOf,n,t)},U.parallelLimit=function(n,t,e){I(b(t),n,e)},U.series=function(n,t){I(U.eachOfSeries,n,t)},U.iterator=function(n){function t(e){function r(){return n.length&&n[e].apply(null,arguments),r.next()}return r.next=function(){return e<n.length-1?t(e+1):null},r}return t(0)},U.apply=g(function(n,t){return g(function(e){return n.apply(null,t.concat(e))})}),U.concat=S(x),U.concatSeries=T(x),U.whilst=function(n,t,e){if(e=e||o,n()){var r=g(function(o,i){o?e(o):n.apply(this,i)?t(r):e.apply(null,[null].concat(i))});t(r)}else e(null)},U.doWhilst=function(n,t,e){var r=0;return U.whilst(function(){return++r<=1||t.apply(this,arguments)},n,e)},U.until=function(n,t,e){return U.whilst(function(){return!n.apply(this,arguments)},t,e)},U.doUntil=function(n,t,e){return U.doWhilst(n,function(){return!t.apply(this,arguments)},e)},U.during=function(n,t,e){e=e||o;var r=g(function(t,r){t?e(t):(r.push(i),n.apply(this,r))}),i=function(n,o){n?e(n):o?t(r):e(null)};n(i)},U.doDuring=function(n,t,e){var r=0;U.during(function(n){r++<1?n(null,!0):t.apply(this,arguments)},n,e)},U.queue=function(n,t){var e=_(function(t,e){n(t[0],e)},t,1);return e},U.priorityQueue=function(n,t){function e(n,t){return n.priority-t.priority}function r(n,t,e){for(var r=-1,o=n.length-1;r<o;){var i=r+(o-r+1>>>1);e(t,n[i])>=0?r=i:o=i-1}return r}function i(n,t,i,u){if(null!=u&&"function"!=typeof u)throw new Error("task callback must be a function");return n.started=!0,M(t)||(t=[t]),0===t.length?U.setImmediate(function(){n.drain()}):void f(t,function(t){var c={data:t,priority:i,callback:"function"==typeof u?u:o};n.tasks.splice(r(n.tasks,c,e)+1,0,c),n.tasks.length===n.concurrency&&n.saturated(),U.setImmediate(n.process)})}var u=U.queue(n,t);return u.push=function(n,t,e){i(u,n,t,e)},delete u.unshift,u},U.cargo=function(n,t){return _(n,1,t)},U.log=P("log"),U.dir=P("dir"),U.memoize=function(n,t){var e={},r={},o=Object.prototype.hasOwnProperty;t=t||i;var u=g(function(i){var u=i.pop(),c=t.apply(null,i);o.call(e,c)?U.setImmediate(function(){u.apply(null,e[c])}):o.call(r,c)?r[c].push(u):(r[c]=[u],n.apply(null,i.concat([g(function(n){e[c]=n;var t=r[c];delete r[c];for(var o=0,i=t.length;o<i;o++)t[o].apply(null,n)})])))});return u.memo=e,u.unmemoized=n,u},U.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},U.times=C(U.map),U.timesSeries=C(U.mapSeries),U.timesLimit=function(n,t,e,r){return U.mapLimit(d(n),t,e,r)},U.seq=function(){var n=arguments;return g(function(t){var e=this,r=t[t.length-1];"function"==typeof r?t.pop():r=o,U.reduce(n,t,function(n,t,r){t.apply(e,n.concat([g(function(n,t){r(n,t)})]))},function(n,t){r.apply(e,[n].concat(t))})})},U.compose=function(){return U.seq.apply(null,Array.prototype.reverse.call(arguments))},U.applyEach=R(U.eachOf),U.applyEachSeries=R(U.eachOfSeries),U.forever=function(n,t){function e(n){return n?r(n):void i(e)}var r=a(t||o),i=q(n);e()},U.ensureAsync=q,U.constant=g(function(n){var t=[null].concat(n);return function(n){return n.apply(this,t)}}),U.wrapSync=U.asyncify=function(n){return g(function(t){var e,r=t.pop();try{e=n.apply(this,t)}catch(n){return r(n)}z(e)&&"function"==typeof e.then?e.then(function(n){r(null,n)}).catch(function(n){r(n.message?n:new Error(n))}):r(null,e)})},"object"===("undefined"==typeof e?"undefined":_typeof(e))&&e.exports?e.exports=U:"function"==typeof n&&n.amd?n([],function(){return U}):F.async=U}()}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:3}],3:[function(n,t,e){function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(n){if(f===setTimeout)return setTimeout(n,0);if((f===r||!f)&&setTimeout)return f=setTimeout,setTimeout(n,0);try{return f(n,0)}catch(t){try{return f.call(null,n,0)}catch(t){return f.call(this,n,0)}}}function u(n){if(p===clearTimeout)return clearTimeout(n);if((p===o||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(n);try{return p(n)}catch(t){try{return p.call(null,n)}catch(t){return p.call(this,n)}}}function c(){m&&h&&(m=!1,h.length?y=h.concat(y):v=-1,y.length&&a())}function a(){if(!m){var n=i(c);m=!0;for(var t=y.length;t;){for(h=y,y=[];++v<t;)h&&h[v].run();v=-1,t=y.length}h=null,m=!1,u(n)}}function l(n,t){this.fun=n,this.array=t}function s(){}var f,p,d=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:r}catch(n){f=r}try{p="function"==typeof clearTimeout?clearTimeout:o}catch(n){p=o}}();var h,y=[],m=!1,v=-1;d.nextTick=function(n){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];y.push(new l(n,t)),1!==y.length||m||i(a)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=s,d.addListener=s,d.once=s,d.off=s,d.removeListener=s,d.removeAllListeners=s,d.emit=s,d.binding=function(n){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(n){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],4:[function(n,t,e){function r(n,t){return Object.prototype.hasOwnProperty.call(n,t)}t.exports=function(n,t,e,i){t=t||"&",e=e||"=";var u={};if("string"!=typeof n||0===n.length)return u;var c=/\+/g;n=n.split(t);var a=1e3;i&&"number"==typeof i.maxKeys&&(a=i.maxKeys);var l=n.length;a>0&&l>a&&(l=a);for(var s=0;s<l;++s){var f,p,d,h,y=n[s].replace(c,"%20"),m=y.indexOf(e);m>=0?(f=y.substr(0,m),p=y.substr(m+1)):(f=y,p=""),d=decodeURIComponent(f),h=decodeURIComponent(p),r(u,d)?o(u[d])?u[d].push(h):u[d]=[u[d],h]:u[d]=h}return u};var o=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)}},{}],5:[function(n,t,e){function r(n,t){if(n.map)return n.map(t);for(var e=[],r=0;r<n.length;r++)e.push(t(n[r],r));return e}var o=function(n){switch("undefined"==typeof n?"undefined":_typeof(n)){case"string":return n;case"boolean":return n?"true":"false";case"number":return isFinite(n)?n:"";default:return""}};t.exports=function(n,t,e,c){return t=t||"&",e=e||"=",null===n&&(n=void 0),"object"===("undefined"==typeof n?"undefined":_typeof(n))?r(u(n),function(u){var c=encodeURIComponent(o(u))+e;return i(n[u])?r(n[u],function(n){return c+encodeURIComponent(o(n))}).join(t):c+encodeURIComponent(o(n[u]))}).join(t):c?encodeURIComponent(o(c))+e+encodeURIComponent(o(n)):""};var i=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)},u=Object.keys||function(n){var t=[];for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&t.push(e);return t}},{}],6:[function(n,t,e){e.decode=e.parse=n("./decode"),e.encode=e.stringify=n("./encode")},{"./decode":4,"./encode":5}],7:[function(n,t,e){var r=n("async"),o=n("../../../../SupClient/fetch"),i=function(){function n(n,t,e){var r=this;this.entriesById={},this.entriesByPath={},this.resources={},this.assetsById={},this.outerAssetsById={},this.tick=function(n){void 0===n&&(n=0),r.tickAnimationFrameId=requestAnimationFrame(r.tick),r.accumulatedTime+=n-r.lastTimestamp,r.lastTimestamp=n;var t=r.gameInstance.tick(r.accumulatedTime),e=t.updates,o=t.timeLeft;return r.accumulatedTime=o,r.gameInstance.input.exited?void cancelAnimationFrame(r.tickAnimationFrameId):void(e>0&&r.gameInstance.draw())},this.canvas=n,this.dataURL=t,e.enableOnExit=!0,this.gameInstance=new SupEngine.GameInstance(this.canvas,e)}return n.prototype.load=function(n,t){var e=this,o=0,i=function(){o++;var t=e.resourcesToLoad.length+e.assetsToLoad.length;n(o,t)};r.series([function(n){e._loadManifest(n)},function(n){e._loadResources(i,n)},function(n){e._loadAssets(i,n)},function(n){e._initPlugins(n)},function(n){e._startPlugins(n)},function(n){e._lateStartPlugins(n)}],t)},n.prototype._loadManifest=function(n){var t=this;this.getAssetData("project.json","json",function(e,r){if(null!=e)return void n(new Error("Failed to load game manifest"));t.gameName=r.name,document.title=r.name,t.resourcesToLoad=Object.keys(SupRuntime.resourcePlugins),t.assetsToLoad=[];for(var o=function n(e,r,o){void 0===r&&(r=""),void 0===o&&(o="");var i;if(null!=e.children){i=[];for(var u=0,c=e.children;u<c.length;u++){var a=c[u];i.push(a.name)}}var l=""+r+e.name;if(o+=e.name+" ("+e.id+")",t.assetsToLoad.push({id:e.id,name:e.name,path:l,storagePath:o,type:e.type,children:i}),r+=e.name+"/",o+="/",null!=e.children)for(var s=0,f=e.children;s<f.length;s++){var a=f[s];n(a,r,o)}},i=0,u=r.assets;i<u.length;i++){var c=u[i];o(c)}n()})},n.prototype._loadResources=function(n,t){var e=this;if(0===this.resourcesToLoad.length)return void t();var r=0,o=function(o,i,u){return null!=o?void t(new Error("Failed to load resource "+i+": "+o.message)):(e.resources[i]=u,n(),r++,void(r===e.resourcesToLoad.length&&t()))};this.resourcesToLoad.forEach(function(n){var t=SupRuntime.resourcePlugins[n];return null==t?void o(null,n,null):void t.loadResource(e,n,function(t,e){o(t,n,e)})})},n.prototype._loadAssets=function(n,t){var e=this;if(null==this.gameInstance.threeRenderer)return void t(new Error("Failed to initialize renderer. Your device might not support WebGL."));if(0===this.assetsToLoad.length)return void t();var r=0,o=function(o,i,u){return null!=o?void t(new Error("Failed to load asset "+i.path+": "+o.message)):(e.entriesById[i.id]=i,e.entriesByPath[i.path]=i,e.assetsById[i.id]=u,n(),r++,void(r===e.assetsToLoad.length&&t()))};this.assetsToLoad.forEach(function(n){if(null!=n.children)return void o(null,n,{});var t=SupRuntime.plugins[n.type];return null==t||null==t.loadAsset?(console.warn("Don't know how to load assets of type \""+n.type+'"'),void o(null,n,{})):void t.loadAsset(e,n,function(t,e){o(t,n,e)})})},n.prototype._initPlugins=function(n){var t=this;r.each(Object.keys(SupRuntime.plugins),function(n,e){var r=SupRuntime.plugins[n];null!=r.init?r.init(t,e):e()},n)},n.prototype._startPlugins=function(n){var t=this;r.each(Object.keys(SupRuntime.plugins),function(n,e){var r=SupRuntime.plugins[n];null!=r.start?r.start(t,e):e()},n)},n.prototype._lateStartPlugins=function(n){var t=this;r.each(Object.keys(SupRuntime.plugins),function(n,e){var r=SupRuntime.plugins[n];null!=r.lateStart?r.lateStart(t,e):e()},n)},n.prototype.run=function(){this.lastTimestamp=0,this.accumulatedTime=0,this.canvas.focus(),this.tick()},n.prototype.getAssetData=function(n,t,e){o.default(""+this.dataURL+n,t,e)},n.prototype.getOuterAsset=function(n){var t=this.outerAssetsById[n],e=this.assetsById[n],r=this.entriesById[n];if(null==t&&null!=e)if(null==r.type)t={name:r.name,path:r.path,type:"folder",children:r.children};else{var o=SupRuntime.plugins[this.entriesById[n].type];t=this.outerAssetsById[n]=null!=o.createOuterAsset?o.createOuterAsset(this,e):e,t.name=r.name,t.path=r.path,t.type=r.type}return t},n.prototype.createActor=function(){throw new Error("Player.createActor should be defined by a scripting plugin")},n.prototype.createComponent=function(){throw new Error("Player.createComponent should be defined by a scripting plugin")},n}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},{"../../../../SupClient/fetch":1,async:2}],8:[function(n,t,e){(function(t){function r(n,t){return null!=e.plugins[n]?void console.error('SupRuntime.registerPlugin: Tried to register two or more plugins named "'+n+'"'):void(e.plugins[n]=t)}function o(n,t){return null!=e.resourcePlugins[n]?void console.error('SupRuntime.registerResource: Tried to register two or more resources named "'+n+'"'):void(e.resourcePlugins[n]=t)}var i=n("async"),u=n("querystring"),c=n("../../../../SupClient/fetch"),a=n("./Player");if(e.Player=a.default,e.plugins={},e.resourcePlugins={},e.registerPlugin=r,e.registerResource=o,SupCore.system=new SupCore.System("",""),null==t.SupApp){t.SupApp=null;try{t.SupApp=null!=top.SupApp?top.SupApp:null}catch(n){}}var l,s;if(null!=SupApp)l=SupApp.getCurrentWindow();else{var f=n;try{s=f("electron")}catch(n){}null!=s&&(l=s.remote.getCurrentWindow())}null!=l&&(document.body.addEventListener("click",function(n){if("A"===n.target.tagName){n.preventDefault();var t=n.target.href;null!=SupApp?SupApp.openLink(t):s.shell.openExternal(t)}}),null!=SupApp&&SupApp.onMessage("force-quit",function(){l.close()}));var p=u.parse(window.location.search.slice(1));document.body.addEventListener("keydown",function(n){n.keyCode===window.KeyEvent.DOM_VK_F12&&null!=p.project&&null!=l&&l.webContents.toggleDevTools()});var d=document.querySelector("progress"),h=document.getElementById("loading"),y=document.querySelector("canvas");y.addEventListener("keypress",function(n){n.preventDefault()}),document.addEventListener("click",function(){return y.focus()}),null!=p.debug&&null!=l&&l.webContents.openDevTools();var m,v=function(n,t){d.value=n,d.max=t},g=function(n){if(null!=n){console.error(n);var t=h.querySelector("a");t.parentElement.removeChild(t);var e=document.createElement("div");return e.className="error",e.textContent=n.message,void h.appendChild(e)}setTimeout(function(){h.classList.remove("start"),h.classList.add("end"),setTimeout(function(){h.parentElement.removeChild(h),m.run()},null==p.project?500:0)},null==p.project?500:0)},w=["components","runtime","typescriptAPI"];c.default("plugins.json","json",function(n,t){return null!=n?(console.log(n),void g(new Error("Could not load plugins list."))):void i.each(t.list,function(n,t){i.each(w,function(t,e){var r=document.createElement("script");r.src="plugins/"+n+"/bundles/"+t+".js",r.addEventListener("load",function(){return e(null)}),r.addEventListener("error",function(n){return e(null)}),document.body.appendChild(r)},t)},function(n){null!=n&&console.log(n);var t=null!=p.project?"/builds/"+p.project+"/"+p.build+"/":"./";m=new a.default(y,t,{debug:null!=p.debug}),m.load(v,g)})}),h.classList.add("start")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../../../SupClient/fetch":1,"./Player":7,async:2,querystring:6}]},{},[8])(8)});