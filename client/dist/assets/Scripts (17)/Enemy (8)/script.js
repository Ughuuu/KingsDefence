"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,i,o){return i&&e(t.prototype,i),o&&e(t,o),t}}();Sup.ArcadePhysics2D.setGravity(0,-.005);var EnemyScript=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.states={},e.speed=.02,e.jumpSpeed=.1,e.flipX=1,e}return _inherits(t,e),_createClass(t,[{key:"awake",value:function(){this.states.Attack={enable:!1,loop:!1},this.states.Walk={enable:!1,loop:!0},this.states.Idle={enable:!0,loop:!0}}},{key:"update",value:function(){this.checkCollision(),this.vel=this.actor.arcadeBody2D.getVelocity(),this.moveLogic(),this.extraLogic(),this.updateAnimation(),this.actor.arcadeBody2D.setVelocity(this.vel)}},{key:"isOtherThan",value:function(e){for(var t in this.states){var i=this.states[t];if(i.enable){var o=!0,s=!1,n=void 0;try{for(var r,a=e[Symbol.iterator]();!(o=(r=a.next()).done);o=!0){var l=r.value;if(t==l)return!1}}catch(e){s=!0,n=e}finally{try{!o&&a.return&&a.return()}finally{if(s)throw n}}return!0}}return!1}},{key:"dontMoveX",value:function(){this.vel.x=0}},{key:"moveLeft",value:function(){this.vel.x=-1*this.speed}},{key:"moveRight",value:function(){this.vel.x=1*this.speed}},{key:"moveLogic",value:function(){0!=this.dir?this.states.Walk.enable=!0:(this.states.Walk.enable=!1,this.states.Idle.enable=!0)}},{key:"moveUp",value:function(){this.vel.y=this.jumpSpeed}},{key:"updateAnimation",value:function(){for(var e in this.states){var t=this.states[e],i=this.actor.spriteRenderer.getAnimationFrameCount(),o=this.actor.spriteRenderer.getAnimationFrameIndex();if(1==t.enable&&0==t.loop&&o==i-1&&(t.enable=!1),1==t.enable){this.actor.spriteRenderer.setAnimation(e);break}}this.actor.spriteRenderer.setHorizontalFlip(this.flip*this.flipX==1)}},{key:"checkCollision",value:function(){var e=this.actor.arcadeBody2D.getTouches().bottom;Sup.ArcadePhysics2D.collides(this.actor.arcadeBody2D,Sup.ArcadePhysics2D.getAllBodies()),e&&(0==this.vel.x?this.dir=0:this.vel.x>0?(this.flip=-1,this.dir=1):(this.flip=1,this.dir=-1))}},{key:"extraLogic",value:function(){var e=this.actor.arcadeBody2D.getTouches().bottom;this.isOtherThan(["Walk","Idle"])?this.dontMoveX():(Sup.Input.isKeyDown("A")?this.moveLeft():Sup.Input.isKeyDown("D")?this.moveRight():this.dontMoveX(),e&&Sup.Input.wasKeyJustPressed("W")&&this.moveUp()),Sup.Input.isKeyDown("S")&&(this.states.Attack.enable=!0,Sup.Audio.playSound("Sound/Sound",.1))}}]),t}(Sup.Behavior);Sup.registerBehavior(EnemyScript);